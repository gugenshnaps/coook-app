<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coook - Caf√©s Brasileiros</title>
    <!-- Force CSS reload with version parameter -->
    <link rel="stylesheet" href="styles.css?v=2.1">
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, where, orderBy, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCBv4tfDPHboApf6CXtUqLIReQA4KzjQJg",
            authDomain: "coook-app.firebaseapp.com",
            projectId: "coook-app",
            storageBucket: "coook-app.firebasestorage.app",
            messagingSenderId: "1027223490741",
            appId: "1:1027223490741:web:a56a826d5d16d517f2aefc",
            measurementId: "G-1XZV0W4QPR"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Make Firebase available globally with the structure expected by script.js
        window.firebase = { 
            db, 
            collection, 
            getDocs, 
            addDoc, 
            updateDoc, 
            deleteDoc, 
            doc, 
            onSnapshot, 
            query, 
            where, 
            orderBy,
            arrayUnion
        };
        
        console.log('üî• Firebase initialized successfully!');
        console.log('üî• Firebase functions available:', Object.keys(window.firebase));
    </script>
    

</head>
<body>
    <!-- Header —Å –∞–≤–∞—Ç–∞—Ä–æ–º –∏ –≤—ã–±–æ—Ä–æ–º –≥–æ—Ä–æ–¥–∞ -->
    <header class="app-header">
        <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å - –∞–≤–∞—Ç–∞—Ä –∏ –Ω–∏–∫–Ω–µ–π–º -->
        <div class="user-info">
            <div class="user-avatar">
                <img id="userAvatar" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM0QTkwRTIiLz4KPHN2ZyB4PSIxMiIgeT0iMTIiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiBmaWxsPSJub25lIj4KPHBhdGggZD0iTTggMTJDMTAuMjA5MSAxMiAxMiAxMC4yMDkxIDEyIDhDMTIgNS43OTA5IDEwLjIwOTEgNCA4IDRDNS43OTA5IDQgNCA1Ljc5MDkgNCA4QzQgMTAuMjA5MSA1Ljc5MDkgNCA4IDRaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNOCAxNEMxMC4yMDkxIDE0IDEyIDEyLjIwOTEgMTIgMTBDMTIgOS43OTA5IDEwLjIwOTEgOCA4IDhDNi4yMDkxIDggNCA5Ljc5MDkgNCAxMkM0IDEyLjIwOTEgNi4yMDkxIDE0IDggMTRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+" alt="Avatar">
            </div>
            <div class="user-details">
                <div id="userName" class="user-name">Carregando...</div>
                <div class="user-status">Online</div>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ -->
        <div class="city-selector">
            <select id="citySelect" class="city-select">
                <option value="">Carregando cidades...</option>
            </select>
            <button id="showAllCafes" class="btn-show-all" style="display: none;">Mostrar todos</button>
        </div>
    </header>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
                    <!-- –ú–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
        <div class="app-menu">
            <button class="menu-item loyalty-btn">
                <span class="menu-icon">üéØ</span>
                <span class="menu-text">Minha Lealdade</span>
            </button>
            <button class="menu-item favorites-btn">
                <span class="menu-icon">‚ù§Ô∏è</span>
                <span class="menu-text">Favoritos</span>
            </button>
        </div>
        
        <!-- –°–ø–∏—Å–æ–∫ –∫–∞—Ñ–µ -->
        <div id="cafesList" class="cafes-list">
            <div class="loading">Selecione uma cidade para ver os caf√©s</div>
        </div>
        
        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–∞—Ñ–µ -->
        <div id="noCafes" class="no-cafes" style="display: none;">
            <p>Nenhum caf√© encontrado nesta cidade</p>
        </div>
    </main>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∫–∞—Ñ–µ -->
    <div id="modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- QR Code Library - Try different versions -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <script>
        // Check if library loaded
        setTimeout(() => {
            console.log('üîç QR Library check after 2 seconds:');
            console.log('   - window.QRCode:', !!window.QRCode);
            console.log('   - window.qrcode:', !!window.qrcode);
            console.log('   - window.qrcodeGenerator:', !!window.qrcodeGenerator);
            
            if (!window.QRCode && !window.qrcode && !window.qrcodeGenerator) {
                console.log('üîÑ Trying alternative QR library...');
                const script = document.createElement('script');
                script.src = 'https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js';
                script.onload = () => {
                    console.log('‚úÖ Alternative QR library loaded');
                    console.log('   - window.QRCode after load:', !!window.QRCode);
                };
                script.onerror = () => {
                    console.error('‚ùå Alternative QR library failed');
                    // Try one more CDN
                    const script2 = document.createElement('script');
                    script2.src = 'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js';
                    script2.onload = () => console.log('‚úÖ Third QR library loaded');
                    script2.onerror = () => console.error('‚ùå All QR libraries failed');
                    document.head.appendChild(script2);
                };
                document.head.appendChild(script);
            }
        }, 2000);
    </script>
    
    <script src="user-system.js"></script>
    <script src="script.js"></script>
</body>
</html>
